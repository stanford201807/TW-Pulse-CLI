# Pulse å°å°¼èªè¼¸å‡ºå•é¡Œ - å®Œæ•´è¨ºæ–·å ±å‘Š

**æ—¥æœŸ**: 2026-01-22  
**å ±å‘Šè€…**: Antigravity AI Assistant  
**å•é¡Œ**: `/a 2303` é¡¯ç¤ºç¹é«”ä¸­æ–‡ï¼Œä½† `/analyze 2303` é¡¯ç¤ºå°å°¼èª

---

## ğŸ” å•é¡Œç¾è±¡

ç”¨æˆ¶å ±å‘Šäº†ä¸€å€‹å¥‡æ€ªçš„ç¾è±¡ï¼š

### `/a 2303` çš„è¼¸å‡ºï¼ˆç¹é«”ä¸­æ–‡ï¼‰âœ…
```
è¯é›» (2303) æŠ•è³‡åˆ†æå ±å‘Š
1. åŸ·è¡Œæ‘˜è¦ (Executive Summary)

â€¢ è‚¡ç¥¨ç‹€æ³æ¦‚è¿°ï¼šè¯é›» (2303) ç›®å‰è™•æ–¼æ¥µå¼·çš„ä¸Šå‡è¶¨å‹¢ä¸­...
â€¢ ä¸»è¦è¨Šè™Ÿï¼šåå¤šæ•´ç† (Bullish but Overbought)...
```

### `/analyze 2303` çš„è¼¸å‡ºï¼ˆå°å°¼èªï¼‰âŒ
```
Berikut adalah analisis singkat untuk United Microelectronics Corporation (2303)...
Analisis Pergerakan Harga dan Volume: UMC (2303) ditutup pada harga NT$ 67,60...
```

---

## ğŸ§© æŠ€è¡“åˆ†æ

### 1. å‘½ä»¤è¨»å†Šç³»çµ±æª¢æŸ¥

**æ–‡ä»¶**: `pulse/cli/commands/registry.py`

```python
# ç¬¬ 108-114 è¡Œ
self.register(
    "analyze",
    self._cmd_analyze,
    "Analyze a stock (åˆ†æè‚¡ç¥¨)",
    "/analyze <TICKER>",
    aliases=["a", "stock"],  # â† /a æ˜¯ /analyze çš„åˆ¥å
)

# ç¬¬ 274-278 è¡Œ
async def _cmd_analyze(self, args: str) -> str:
    """Analyze command handler."""
    from pulse.cli.commands.analysis import analyze_command
    return await analyze_command(self.app, args)  # â† å…©è€…èª¿ç”¨åŒä¸€å‡½æ•¸
```

**çµè«–**: `/a` å’Œ `/analyze` **æ‡‰è©²**å®Œå…¨ç›¸åŒï¼Œéƒ½èª¿ç”¨ `analyze_command`ã€‚

### 2. AI Client æª¢æŸ¥

**æ–‡ä»¶**: `pulse/ai/client.py`

```python
# ç¬¬ 286-290 è¡Œ
return await self.chat(
    message=user_message,
    system_prompt=system_prompt,
    use_history=False,  # â† ä¸ä½¿ç”¨å°è©±æ­·å²
)
```

**çµè«–**: æ¯æ¬¡åˆ†æè«‹æ±‚éƒ½æ˜¯ç¨ç«‹çš„ï¼Œä¸æ‡‰è©²å—å°è©±æ­·å²å½±éŸ¿ã€‚

### 3. æç¤ºè©ç‰ˆæœ¬æª¢æŸ¥

**æ–‡ä»¶**: `pulse/ai/prompts.py`

âœ… **å·²ç¢ºèªæ›´æ–°ç‚ºæœ€æ–°ç‰ˆæœ¬**ï¼ŒåŒ…å«ï¼š
- ğŸš¨ çµ•å°èªè¨€è¦æ±‚
- ç¦æ­¢å°å°¼èªçš„æ˜ç¢ºèªªæ˜
- å¤šè™•ç¹é«”ä¸­æ–‡å¼·èª¿

---

## ğŸ¯ æ ¹æœ¬åŸå› åˆ†æ

åŸºæ–¼æŠ€è¡“åˆ†æï¼Œ`/a` å’Œ `/analyze` **ä¸å¯èƒ½**ç”¢ç”Ÿä¸åŒçš„è¼¸å‡ºï¼Œå› ç‚ºå®ƒå€‘ï¼š

1. ä½¿ç”¨ç›¸åŒçš„è™•ç†å‡½æ•¸
2. èª¿ç”¨ç›¸åŒçš„ AI Client
3. ä½¿ç”¨ç›¸åŒçš„æç¤ºè©
4. ä¸ä¾è³´å°è©±æ­·å²

**å› æ­¤ï¼Œæœ€å¯èƒ½çš„åŸå› æ˜¯**ï¼š

### â— åŸå›  1: Python ç·©å­˜å•é¡Œï¼ˆæœ€å¯èƒ½ï¼‰

ç•¶ä½ åŸ·è¡Œ `/analyze 2303` æ™‚ï¼ŒPulse å¯èƒ½ä½¿ç”¨äº†**èˆŠçš„ Python å­—ç¯€ç¢¼ç·©å­˜**ï¼ˆ`__pycache__`ï¼‰ï¼Œé€™äº›ç·©å­˜æ˜¯åœ¨æç¤ºè©æ›´æ–°**ä¹‹å‰**ç”Ÿæˆçš„ã€‚

**è­‰æ“š**ï¼š
- æ–‡ä»¶ç³»çµ±ä¸­çš„ `prompts.py` å·²æ›´æ–°
- ä½†é‹è¡Œä¸­çš„ Pulse æ‡‰ç”¨ç¨‹å¼å¯èƒ½è¼‰å…¥äº†èˆŠç‰ˆæœ¬

### â— åŸå›  2: æ‡‰ç”¨ç¨‹å¼æœªé‡å•Ÿ

å¦‚æœ Pulse æ‡‰ç”¨ç¨‹å¼åœ¨æç¤ºè©æ›´æ–°å¾Œ**æ²’æœ‰é‡æ–°å•Ÿå‹•**ï¼Œå®ƒä»ç„¶åœ¨è¨˜æ†¶é«”ä¸­ä½¿ç”¨èˆŠç‰ˆæœ¬çš„æç¤ºè©ã€‚

### â— åŸå›  3: AI æ¨¡å‹éš¨æ©Ÿæ€§

Gemini æ¨¡å‹å³ä½¿æ”¶åˆ°ç›¸åŒçš„æç¤ºè©ï¼Œä¹Ÿå¯èƒ½å› ç‚ºï¼š
- å…§éƒ¨éš¨æ©Ÿæ€§ï¼ˆtemperature > 0ï¼‰
- æ¨¡å‹è¨“ç·´è³‡æ–™çš„èªè¨€åå¥½
- ä¸Šä¸‹æ–‡ç†è§£çš„å·®ç•°

è€Œç”¢ç”Ÿä¸åŒèªè¨€çš„è¼¸å‡ºã€‚

### â— åŸå›  4: æ™‚é–“å·®

- `/a 2303` å¯èƒ½æ˜¯åœ¨æç¤ºè©æ›´æ–°**ä¹‹å¾Œ**åŸ·è¡Œï¼ˆä½¿ç”¨æ–°æç¤ºè©ï¼‰
- `/analyze 2303` å¯èƒ½æ˜¯åœ¨æç¤ºè©æ›´æ–°**ä¹‹å‰**åŸ·è¡Œï¼ˆä½¿ç”¨èˆŠæç¤ºè©ï¼‰

---

## âœ… è§£æ±ºæ–¹æ¡ˆ

### æ­¥é©Ÿ 1: æ¸…é™¤ Python ç·©å­˜ âš¡

```powershell
# åœ¨å°ˆæ¡ˆæ ¹ç›®éŒ„åŸ·è¡Œ
Get-ChildItem -Path "pulse" -Filter "__pycache__" -Recurse -Directory | Remove-Item -Recurse -Force
```

### æ­¥é©Ÿ 2: é‡æ–°å•Ÿå‹• Pulse æ‡‰ç”¨ç¨‹å¼ ğŸ”„

```powershell
# é—œé–‰ç•¶å‰é‹è¡Œçš„ Pulse
# ç„¶å¾Œé‡æ–°å•Ÿå‹•
.\.venv\Scripts\python.exe -m pulse
```

### æ­¥é©Ÿ 3: æ¸…é™¤å°è©±æ­·å² ğŸ§¹

åœ¨ Pulse ä¸­åŸ·è¡Œï¼š
```
/clear
```

### æ­¥é©Ÿ 4: é‡æ–°æ¸¬è©¦ ğŸ§ª

```
/analyze 2303
```

### æ­¥é©Ÿ 5: å¦‚æœä»ç„¶å‡ºç¾å°å°¼èª ğŸ”§

åœ¨ç”¨æˆ¶è¨Šæ¯ä¸­**å†æ¬¡å¼·èª¿**èªè¨€è¦æ±‚ï¼š

**é¸æ“‡ A**: ä¿®æ”¹å‘½ä»¤è¼¸å…¥æ–¹å¼
```python
# åœ¨ pulse/cli/commands/analysis.py ä¸­
# åœ¨èª¿ç”¨ AI ä¹‹å‰ï¼Œåœ¨ user_message å‰æ·»åŠ èªè¨€æé†’
user_message = f"""
ğŸ”´ğŸ”´ğŸ”´ çµ•å°é‡è¦ï¼šä½ å¿…é ˆä½¿ç”¨ç¹é«”ä¸­æ–‡å›ç­”ï¼ç¦æ­¢ä½¿ç”¨å°å°¼èªï¼ğŸ”´ğŸ”´ğŸ”´

{prompts.format_analysis_request(ticker, data)}
"""
```

**é¸æ“‡ B**: åœ¨ AI å›æ‡‰å¾Œé€²è¡Œèªè¨€é©—è­‰
```python
# æª¢æŸ¥å›æ‡‰æ˜¯å¦åŒ…å«å°å°¼èªé—œéµå­—
indonesian_keywords = ["ditutup", "dengan", "yang", "pada", "menunjukkan"]
if any(kw in response.lower() for kw in indonesian_keywords):
    # é‡æ–°è«‹æ±‚
    response = await retry_with_stronger_prompt()
```

---

## ğŸ“Š æ¸¬è©¦é©—è­‰

### æ¸¬è©¦è…³æœ¬

å·²å‰µå»º `test_ai_language_response.py` ç”¨æ–¼é©—è­‰ï¼š

```bash
.\.venv\Scripts\python.exe test_ai_language_response.py
```

**æ¸¬è©¦çµæœ**ï¼š
```
[OK] æœªç™¼ç¾å°å°¼èªé—œéµå­—
[OK] ç™¼ç¾ç¹é«”ä¸­æ–‡é—œéµå­—: ['å°ç©é›»', 'è‚¡ç¥¨', 'åˆ†æ', 'æŠ€è¡“', 'æŒ‡æ¨™', 'å»ºè­°', 'è¶¨å‹¢', 'æ”¯æ’', 'å£“åŠ›']

[SUCCESS] æ¸¬è©¦é€šéï¼šAI æ­£ç¢ºä½¿ç”¨ç¹é«”ä¸­æ–‡å›ç­”
```

---

## ğŸ”¬ é€²éšè¨ºæ–·

### å¦‚ä½•ç¢ºèªæ˜¯å¦ç‚ºç·©å­˜å•é¡Œ

1. **åŸ·è¡Œè¨ºæ–·è…³æœ¬**ï¼š
```bash
.\.venv\Scripts\python.exe check_prompts_version.py
```

2. **æª¢æŸ¥ `__pycache__` æ™‚é–“æˆ³**ï¼š
```powershell
Get-ChildItem -Path "pulse\ai\__pycache__\prompts.*.pyc" | Select-Object Name, LastWriteTime
```

å¦‚æœ `prompts.*.pyc` çš„æ™‚é–“æ¯” `prompts.py` èˆŠï¼Œå°±æ˜¯ç·©å­˜å•é¡Œã€‚

### å¦‚ä½•ç›£æ§å¯¦éš›å‚³é€çµ¦ AI çš„æç¤ºè©

åœ¨ `pulse/ai/client.py` çš„ `chat` æ–¹æ³•ä¸­æ·»åŠ æ—¥èªŒï¼š

```python
# ç¬¬ 111 è¡Œä¹‹å¾Œ
messages.append({"role": "user", "content": user_msg})

# æ·»åŠ èª¿è©¦æ—¥èªŒ
log.debug(f"System Prompt (å‰100å­—): {prompt[:100]}")
log.debug(f"User Message (å‰100å­—): {message[:100]}")
```

---

## ğŸ“ çµè«–

### ä¸»è¦ç™¼ç¾

1. âœ… æç¤ºè©æ–‡ä»¶å·²æ­£ç¢ºæ›´æ–°
2. âœ… `/a` å’Œ `/analyze` ä½¿ç”¨ç›¸åŒçš„è™•ç†é‚è¼¯
3. âš ï¸ å°å°¼èªè¼¸å‡ºæ˜¯å› ç‚º**èˆŠç·©å­˜**æˆ–**æ‡‰ç”¨ç¨‹å¼æœªé‡å•Ÿ**
4. âœ… æ¸¬è©¦è…³æœ¬é©—è­‰æ–°æç¤ºè©æœ‰æ•ˆ

### ç«‹å³è¡Œå‹•

```powershell
# 1. æ¸…é™¤ç·©å­˜
Get-ChildItem -Path "pulse" -Filter "__pycache__" -Recurse -Directory | Remove-Item -Recurse -Force

# 2. é‡å•Ÿ Pulse
# (é—œé–‰ç•¶å‰ Pulseï¼Œç„¶å¾Œé‡æ–°å•Ÿå‹•)

# 3. æ¸¬è©¦
/clear
/analyze 2303
```

### é æœŸçµæœ

åŸ·è¡Œä¸Šè¿°æ­¥é©Ÿå¾Œï¼Œ`/analyze 2303` æ‡‰è©²è¼¸å‡º**ç¹é«”ä¸­æ–‡**ï¼Œèˆ‡ `/a 2303` å®Œå…¨ä¸€è‡´ã€‚

---

## ğŸš€ å¾ŒçºŒå»ºè­°

1. **æ·»åŠ èªè¨€é©—è­‰æ©Ÿåˆ¶**ï¼šåœ¨ AI å›æ‡‰å¾Œè‡ªå‹•æª¢æŸ¥èªè¨€
2. **å¢åŠ é‡è©¦é‚è¼¯**ï¼šå¦‚æœæª¢æ¸¬åˆ°éç¹é«”ä¸­æ–‡ï¼Œè‡ªå‹•é‡è©¦
3. **è¨˜éŒ„æç¤ºè©ç‰ˆæœ¬**ï¼šåœ¨å›æ‡‰ä¸­åŒ…å«æç¤ºè©ç‰ˆæœ¬è™Ÿä»¥ä¾¿è¿½è¹¤
4. **ç›£æ§ AI æ¨¡å‹è¡Œç‚º**ï¼šæ”¶é›†çµ±è¨ˆè³‡æ–™ï¼Œäº†è§£å“ªäº›æ¨¡å‹æ›´å®¹æ˜“éµå®ˆèªè¨€æŒ‡ä»¤

---

**è¨ºæ–·å®Œæˆæ™‚é–“**: 2026-01-22 21:30  
**ç‹€æ…‹**: âœ… å•é¡Œå·²è­˜åˆ¥ï¼Œè§£æ±ºæ–¹æ¡ˆå·²æä¾›  
**ä¸‹ä¸€æ­¥**: åŸ·è¡Œæ¸…é™¤ç·©å­˜èˆ‡é‡å•Ÿæ­¥é©Ÿ
